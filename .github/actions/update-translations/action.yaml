name: Update Translations
description: Creates a Pull Request updating translations and AUTHORS.
runs:
  using: composite
  steps:
    - name: Check Runner Operating System 🏃‍♂️
      if: runner.os != 'Linux'
      shell: bash
      run: |
        echo "::warning::Action requires Linux-based runner."
        exit 2

    - name: Install and Configure Python 🐍
      shell: bash
      run: |
        python3 -m venv .venv
        source .venv/bin/activate
        python3 -m pip install lxml requests crowdin-api-client

    - name: Update Translations 🌐
      shell: bash
      run: |
        source .venv/bin/activate
        python3 .github/scripts/utils.py/update-translations.py

    - name: Create Pull Request 🔧
      uses: peter-evans/create-pull-request@6ce4eca6b6db0ff4f4d1b542dce50e785446dc27
      with:
        author: Translation Updater <commits@obsproject.com>
        commit-message: Update Translations from Crowdin
        title: Update Translations from Crowdin
        branch: automated/update-translations
        body: |
          This updates translations and authors.

          Creation of this Pull Request manually triggered via ${{ github.workflow_run.workflow_url }}.
        delete-branch: true
